// Test case: Depthwise convolution with dilation [1, 2] - PASSES ✓
// Original kernel: 1x4
// Dilation: [1, 2]
// Expanded kernel: 1x7 (calculated: 4 + (4-1)*(2-1) = 4 + 3 = 7)
// Result: WITHIN 7x7 limit - compilation SUCCESSFUL

module  {
  func.func @main(%input: !torch.vtensor<[1,64,1,10],bf16>) -> !torch.vtensor<[1,64,1,4],bf16> attributes {torch.onnx_meta.ir_version = 11 : si64, torch.onnx_meta.opset_version = 22 : si64, torch.onnx_meta.producer_name = "pytorch", torch.onnx_meta.producer_version = "2.1.1"} {
    %weights = torch.operator "onnx.Constant"() {torch.onnx.value = dense<[[[[0.5, -0.3, 0.8, 0.2]]], [[[0.1, 0.9, -0.4, 0.6]]], [[[-0.2, 0.7, 0.3, -0.5]]], [[[0.4, -0.1, 0.6, 0.8]]], [[[0.9, 0.2, -0.6, 0.3]]], [[[-0.7, 0.5, 0.1, -0.8]]], [[[0.3, 0.6, -0.2, 0.4]]], [[[0.7, -0.3, 0.5, 0.9]]], [[[-0.4, 0.8, 0.2, -0.1]]], [[[0.6, 0.1, -0.5, 0.7]]], [[[0.2, -0.6, 0.9, 0.3]]], [[[-0.8, 0.4, 0.6, -0.2]]], [[[0.5, 0.7, -0.3, 0.1]]], [[[0.8, -0.4, 0.2, 0.6]]], [[[-0.1, 0.3, 0.8, -0.5]]], [[[0.4, 0.9, -0.7, 0.2]]], [[[0.1, -0.2, 0.6, 0.8]]], [[[-0.5, 0.7, 0.3, -0.6]]], [[[0.9, 0.4, -0.1, 0.5]]], [[[0.3, -0.8, 0.7, 0.2]]], [[[-0.4, 0.6, 0.1, -0.9]]], [[[0.7, 0.2, -0.5, 0.8]]], [[[0.5, -0.6, 0.3, 0.4]]], [[[-0.2, 0.9, 0.6, -0.3]]], [[[0.8, 0.1, -0.4, 0.7]]], [[[0.6, -0.7, 0.2, 0.9]]], [[[-0.3, 0.5, 0.8, -0.1]]], [[[0.4, 0.7, -0.9, 0.3]]], [[[0.2, -0.5, 0.6, 0.8]]], [[[-0.6, 0.3, 0.9, -0.4]]], [[[0.7, 0.8, -0.2, 0.5]]], [[[0.9, -0.3, 0.4, 0.1]]], [[[-0.5, 0.2, 0.7, -0.8]]], [[[0.3, 0.6, -0.1, 0.9]]], [[[0.1, -0.4, 0.8, 0.5]]], [[[-0.7, 0.9, 0.2, -0.6]]], [[[0.6, 0.3, -0.8, 0.4]]], [[[0.8, -0.5, 0.7, 0.2]]], [[[-0.3, 0.1, 0.5, -0.9]]], [[[0.4, 0.8, -0.6, 0.3]]], [[[0.2, -0.7, 0.9, 0.6]]], [[[-0.8, 0.4, 0.3, -0.2]]], [[[0.5, 0.6, -0.4, 0.8]]], [[[0.7, -0.2, 0.1, 0.9]]], [[[-0.1, 0.5, 0.6, -0.7]]], [[[0.9, 0.2, -0.8, 0.4]]], [[[0.3, -0.6, 0.7, 0.1]]], [[[-0.4, 0.8, 0.5, -0.3]]], [[[0.6, 0.9, -0.1, 0.7]]], [[[0.8, -0.3, 0.2, 0.5]]], [[[-0.2, 0.6, 0.9, -0.4]]], [[[0.4, 0.1, -0.7, 0.8]]], [[[0.7, -0.5, 0.3, 0.6]]], [[[-0.6, 0.2, 0.8, -0.9]]], [[[0.9, 0.5, -0.3, 0.1]]], [[[0.2, -0.8, 0.4, 0.7]]], [[[-0.5, 0.3, 0.6, -0.1]]], [[[0.8, 0.7, -0.4, 0.2]]], [[[0.1, -0.6, 0.9, 0.3]]], [[[-0.9, 0.4, 0.7, -0.5]]], [[[0.6, 0.8, -0.2, 0.1]]], [[[0.3, -0.4, 0.5, 0.9]]], [[[-0.7, 0.1, 0.8, -0.6]]], [[[0.5, 0.9, -0.3, 0.4]]]]> : tensor<64x1x1x4xbf16>} : () -> !torch.vtensor<[64,1,1,4],bf16>
    %bias = torch.operator "onnx.Constant"() {torch.onnx.value = dense<[0.1, -0.2, 0.3, 0.15, -0.05, 0.25, 0.12, -0.18, 0.08, 0.22, -0.14, 0.19, 0.06, -0.11, 0.17, 0.13, -0.09, 0.21, 0.07, -0.16, 0.24, 0.11, -0.13, 0.18, 0.09, -0.15, 0.23, 0.14, -0.08, 0.16, 0.12, -0.19, 0.2, 0.08, -0.12, 0.17, 0.13, -0.1, 0.19, 0.11, -0.14, 0.22, 0.09, -0.17, 0.15, 0.12, -0.11, 0.2, 0.08, -0.13, 0.18, 0.14, -0.09, 0.16, 0.11, -0.15, 0.21, 0.13, -0.12, 0.19, 0.1, -0.16, 0.23, 0.12]> : tensor<64xbf16>} : () -> !torch.vtensor<[64],bf16>
    
    // Depthwise Conv: 1x4 kernel → dilation [1,2] → expands to 1x7 (PASSES)
    %output = torch.operator "onnx.Conv"(%input, %weights, %bias) {
      torch.onnx.dilations = [1 : si64, 2 : si64], 
      torch.onnx.group = 64 : si64, 
      torch.onnx.kernel_shape = [1 : si64, 4 : si64], 
      torch.onnx.pads = [0 : si64, 0 : si64, 0 : si64, 0 : si64], 
      torch.onnx.strides = [1 : si64, 1 : si64]
    } : (!torch.vtensor<[1,64,1,10],bf16>, !torch.vtensor<[64,1,1,4],bf16>, !torch.vtensor<[64],bf16>) -> !torch.vtensor<[1,64,1,4],bf16>
    
    return %output : !torch.vtensor<[1,64,1,4],bf16>
  }
}
